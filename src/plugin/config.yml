## Plugin Configuration
---
package:
  name: catalog
  description: The catalog panel and associated widgets

services:
  route:
    defaults:
      forceMount: false
    routes:
      # Catalog Index
      # The catalog index is the view which lists additional catalog tools.
      - path: [catalog, {type: literal, name: index, optional: true}]
        params:
          view: catalogIndex

      # plain catalog/apps with optional tag goes to the app browser
      - path: [catalog, apps, {type: param, name: tag, optional: true}]
        params:
          view: appsBrowser

      # App View
      # catalog/apps/NAMESPACE/ID and
      # catalog/apps/NAMESPACE/ID/TAG
      # lead to the app viewer
      - path:
          [
            catalog,
            apps,
            {type: param, name: namespace},
            {type: param, name: id},
            {type: param, name: tag, optional: true},
          ]
        params:
          view: appView

      # Module Browser and View
      - path: [catalog, modules]
        params:
          view: moduleBrowser

      - path: [catalog, modules, {type: param, name: module_name}]
        params:
          view: moduleView

      - path: [catalog, module, {type: param, name: module_name}]
        params:
          view: moduleView

      # Dynamic Services Catalog
      - path: [catalog, services]
        params:
          view: serviceCatalog

      # Functions browser and view
      - path: [catalog, functions, {type: param, name: tag, optional: true}]
        params:
          view: functionBrowser

      - path:
          [
            catalog,
            functions,
            {type: param, name: module},
            {type: param, name: function_id},
            {type: param, name: ver, optional: true},
          ]
        params:
          view: functionView

      # Data Types Browser
      - path: [catalog, datatypes]
        params:
          view: datatypeBrowser

      # Developer Tools

      # Registration view

      # TODO: make sure it works.
      - path:
          [
            catalog,
            register,
            {type: param, name: registration_id, optional: true},
          ]
        params:
          view: catalogRegistration

      - path: [catalog, stats]
        params:
          view: catalogStats

      - path:
          [catalog, status, {type: param, name: module_names, optional: true}]
        params:
          view: catalogStatus

      - path: [catalog, admin]
        params:
          view: catalogAdmin

      - path: [catalog, queue]
        params:
          view: catalogQueue

      # OLD ROUTES
      # Todo: do we still need these?
      # For now, let's just keep the root appcatalog. The rest of the routes
      # (see the old config.yml) are duplicates of most of the above, and i would bet
      # that the vast majority of links to them are generated right here in this
      # plugin.
      # Well, the narrative, at least uses appcatalog links.
      #
      # App Browser
      # The normal user home page for the catalog is the app browser
      # A variant of above (is the above even used?)

      - path:
          [
            appcatalog,
            {type: literal, name: browse, optional: true},
            {type: param, name: tag, optional: true},
          ]
        params:
          view: appsBrowser

      - path:
          [appcatalog, module, {type: param, name: module_name, optional: true}]
        params:
          view: moduleView

      - path:
          [
            appcatalog,
            app,
            {type: param, name: namespace},
            {type: param, name: id},
            {type: param, name: tag, optional: true},
          ]
        params:
          view: appView

      # Different from the 'catalog' version because the registration id is optional
      - path:
          [
            appcatalog,
            register,
            {type: param, name: registration_id, optional: true},
          ]
        params:
          view: catalogRegistration

      - path:
          [
            appcatalog,
            status,
            {type: param, name: module_names, optional: true},
          ]
        params:
          view: catalogStatus

      - path: [appcatalog, service]
        params:
          view: serviceCatalog

      - path: [appcatalog, admin]
        params:
          view: catalogAdmin

      - path: [appcatalog, stats]
        params:
          view: catalogStats

  menu:
    - name: catalog
      definition:
        path: [catalog, apps]
        label: Catalog
        icon: book
